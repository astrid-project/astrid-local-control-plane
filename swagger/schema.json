{
  "produces": [
    "application/json"
  ],
  "consumes": [
    "application/json"
  ],
  "tags": [
    {
      "name": "code",
      "description": "Code injection at run-time."
    },
    {
      "name": "config",
      "description": "Configuration at run-time."
    },
    {
      "name": "status",
      "description": "Status data of the LCP."
    }
  ],
  "paths": {
    "/code": {
      "delete": {},
      "post": {},
      "put": {}
    },
    "/config": {
      "post": {
        "summary": "Configuration update",
        "description": "Apply configuration changes to the local environment.",
        "tags": [
          "config"
        ],
        "parameters": [
          {
            "name": "payload",
            "required": true,
            "in": "body",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/ConfigRequest"
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Configuration changes executed.",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/ConfigResponse"
              }
            }
          },
          "400": {
            "description": "Bad request.",
            "schema": {
              "$ref": "#/definitions/HTTPError"
            }
          },
          "401": {
            "description": "Unauthorized.",
            "schema": {
              "$ref": "#/definitions/HTTPError"
            }
          }
        }
      }
    },
    "/status": {
      "post": {
        "summary": "Status set.",
        "description": "Set the last heartbeat.",
        "tags": [
          "status"
        ],
        "responses": {
          "200": {
            "description": "Status data of the LCP.",
            "schema": {
              "$ref": "#/definitions/StatusResponse"
            }
          },
          "401": {
            "description": "Unauthorized.",
            "schema": {
              "$ref": "#/definitions/HTTPError"
            }
          }
        }
      }
    }
  },
  "info": {
    "title": "Local Control Plane",
    "version": "cd98692ab9ea4889bb92f0a9ef26292f4aaff62e@master"
  },
  "swagger": "2.0",
  "definitions": {
    "ConfigParameterRequest": {
      "type": "object",
      "properties": {
        "value": {
          "type": "string",
          "description": "Parameter new value.",
          "example": "10s"
        },
        "scheme": {
          "type": "string",
          "description": "Scheme.",
          "example": "yaml"
        },
        "source": {
          "type": "string",
          "description": "Source filename.",
          "example": "filebeat.yml"
        },
        "path": {
          "type": "string",
          "description": "Key path.",
          "example": "period"
        }
      },
      "required": [
        "path",
        "scheme",
        "source",
        "value"
      ]
    },
    "ConfigActionRequest": {
      "type": "object",
      "properties": {
        "args": {
          "type": "string",
          "description": "Single command argument.",
          "example": "-al"
        },
        "daemon": {
          "type": "string",
          "description": "Key used to execute the command as daemon.",
          "example": "firewall"
        },
        "cmd": {
          "type": "string",
          "description": "Command."
        }
      },
      "required": [
        "cmd"
      ]
    },
    "ConfigResourceRequest": {
      "type": "object",
      "properties": {
        "destination": {
          "type": "string",
          "description": "Destination filename",
          "example": "filebeat.yml"
        },
        "content": {
          "type": "string",
          "description": "Resource content."
        }
      },
      "required": [
        "content",
        "destination"
      ]
    },
    "ConfigRequest": {
      "type": "object",
      "properties": {
        "parameters": {
          "description": "List of parameters.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/ConfigParameterRequest"
          }
        },
        "actions": {
          "description": "List of actions.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/ConfigActionRequest"
          }
        },
        "resources": {
          "description": "List of resources.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/ConfigResourceRequest"
          }
        }
      }
    },
    "ConfigResultResponse": {
      "type": "object",
      "properties": {
        "warning": {
          "type": "string",
          "description": "Warning message",
          "example": "Useless property: id"
        },
        "type": {
          "type": "string",
          "description": "Configuration type."
        }
      },
      "required": [
        "type"
      ]
    },
    "ConfigResponse": {
      "type": "object",
      "properties": {
        "when": {
          "type": "string",
          "format": "date-time",
          "description": "Datetime of the configuration changes",
          "example": "2020/02/13 15:27:06"
        },
        "results": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/ConfigResultResponse"
          }
        }
      },
      "required": [
        "results",
        "when"
      ]
    },
    "HTTPError": {
      "type": "object",
      "properties": {
        "title": {
          "type": "string",
          "description": "Title error",
          "example": "400 Bad Request"
        },
        "description": {
          "type": "string",
          "description": "Human readable message that describes the error.",
          "example": "The request body is not a valid JSON or it is not encoded as UTF-8."
        }
      },
      "required": [
        "description",
        "title"
      ]
    },
    "StatusResponse": {
      "type": "object",
      "properties": {
        "last_heartbeat": {
          "type": "string",
          "format": "date-time",
          "example": "2019_02_14 15:23:33",
          "description": "Timestamp of the last hearthbeat between the LCP and the CB"
        },
        "id": {
          "type": "string",
          "description": "ID of the execution environment.",
          "example": "apache"
        },
        "started": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when the LCP is started",
          "example": "2019_02_14 15:23:30"
        }
      },
      "required": [
        "id",
        "last_heartbeat",
        "started"
      ]
    }
  }
}